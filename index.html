<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sjov Matematik - V√¶lg regnearter</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* SIMPLIFICERET STATS BAR TIL FORSIDEN */
    .stats-bar {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 15px;
      padding: 15px 25px;
      margin: 20px 0;
      display: flex;
      justify-content: space-around;
      color: white;
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }
    
    .stat-item {
      text-align: center;
    }
    
    .stat-label {
      font-size: 0.9rem;
      opacity: 0.9;
      margin-bottom: 5px;
    }
    
    .stat-value {
      font-size: 2rem;
      font-weight: bold;
    }
    
    /* MENU ITEMS */
    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    
    .menu-item {
      background: white;
      border-radius: 15px;
      padding: 25px;
      text-decoration: none;
      color: #2d3748;
      display: block;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }
    
    .menu-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0,0,0,0.15);
      border-color: #48bb78;
    }
    
    .menu-icon {
      font-size: 3rem;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .menu-text {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 10px;
      text-align: center;
    }
    
    .menu-desc {
      color: #718096;
      text-align: center;
      display: block;
      margin-bottom: 15px;
    }
    
    .menu-progress {
      height: 6px;
      background: #e2e8f0;
      border-radius: 3px;
      margin-top: 10px;
      overflow: hidden;
    }
    
    .menu-progress-fill {
      height: 100%;
      background: linear-gradient(to right, #48bb78, #38a169);
      border-radius: 3px;
      transition: width 0.5s ease;
    }
    
    /* COMING SOON TAGS */
    .coming-soon {
      background: #f7fafc;
      border: 2px dashed #cbd5e0;
      padding: 10px 20px;
      border-radius: 25px;
      color: #a0aec0;
      font-weight: 600;
    }
    
    /* RESET KNAP */
    .reset-btn {
      background: #f56565;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin: 0 auto;
      transition: all 0.3s;
    }
    
    .reset-btn:hover {
      background: #e53e3e;
      transform: translateY(-2px);
    }
    
    /* RESPONSIVITET */
    @media (max-width: 768px) {
      .stats-bar {
        flex-direction: column;
        gap: 15px;
      }
      
      .stat-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      .stat-value {
        font-size: 1.8rem;
      }
      
      .menu-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1><i class="fas fa-calculator"></i> Sjov Matematik</h1>
      <p>Tr√¶n matematik fra 5. til 9. klasse. V√¶lg en regnearter at starte med!</p>
      
      <!-- SAMLET STATISTIK -->
      <div class="stats-bar">
        <div class="stat-item">
          <div class="stat-label">Samlet rigtige</div>
          <div class="stat-value" id="totalCorrect">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">I Plus</div>
          <div class="stat-value" id="plusCorrect">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Aktivitetsdage</div>
          <div class="stat-value" id="activeDays">1</div>
        </div>
      </div>
    </header>

    <main>
      <h2 style="margin-top: 30px;">V√¶lg et emne:</h2>
      <div class="menu-grid">
        <a href="pages/plus.html" class="menu-item">
          <div class="menu-icon">‚ûï</div>
          <div class="menu-text">Plus</div>
          <small class="menu-desc">L√¶r at l√¶gge tal sammen</small>
          <div class="menu-progress">
            <div class="menu-progress-fill" id="plusProgress" style="width: 0%"></div>
          </div>
        </a>
        
        <a href="pages/minus.html" class="menu-item">
          <div class="menu-icon">‚ûñ</div>
          <div class="menu-text">Minus</div>
          <small class="menu-desc">Tr√¶k tal fra hinanden</small>
          <div class="menu-progress">
            <div class="menu-progress-fill" id="minusProgress" style="width: 0%"></div>
          </div>
        </a>
        
        <a href="pages/gange.html" class="menu-item">
          <div class="menu-icon">‚úñÔ∏è</div>
          <div class="menu-text">Gange</div>
          <small class="menu-desc">Mestring af multiplikation</small>
          <div class="menu-progress">
            <div class="menu-progress-fill" id="gangeProgress" style="width: 0%"></div>
          </div>
        </a>
        
        <a href="pages/division.html" class="menu-item">
          <div class="menu-icon">‚ûó</div>
          <div class="menu-text">Division</div>
          <small class="menu-desc">Del tal ligeligt</small>
          <div class="menu-progress">
            <div class="menu-progress-fill" id="divisionProgress" style="width: 0%"></div>
          </div>
        </a>
      </div>
      
      <!-- KOMMENDE EMNER -->
      <div style="margin-top: 40px; text-align: center;">
        <h3>Snart tilg√¶ngelige emner:</h3>
        <div style="display: flex; justify-content: center; gap: 15px; margin-top: 15px; flex-wrap: wrap;">
          <span class="coming-soon"><i class="fas fa-pizza-slice"></i> Br√∏ker (¬Ω)</span>
          <span class="coming-soon"><i class="fas fa-percentage"></i> Procent (%)</span>
          <span class="coming-soon"><i class="fas fa-equals"></i> Ligninger (=)</span>
          <span class="coming-soon"><i class="fas fa-shapes"></i> Geometri (üìê)</span>
        </div>
      </div>
      
      <!-- RESET KNAP -->
      <div style="text-align: center; margin-top: 40px;">
        <button onclick="resetAllData()" class="reset-btn">
          <i class="fas fa-trash-alt"></i> Nulstil alle data
        </button>
        <p style="font-size: 0.8rem; color: #718096; margin-top: 5px;">Sletter alle dine fremskridt i alle emner</p>
      </div>
    </main>
  </div>

  <script>
    // GLOBALE VARIABLER
    let userData = {
      totalCorrect: 0,
      activeDays: 1,
      lastActiveDate: null,
      topics: {
        plus: { totalCorrect: 0 },
        minus: { totalCorrect: 0 },
        gange: { totalCorrect: 0 },
        division: { totalCorrect: 0 }
      }
    };

    // N√ÖR SIDEN INDL√ÜSES
    document.addEventListener('DOMContentLoaded', function() {
      loadUserData();
      updateStatsDisplay();
      checkActiveDay();
    });

    // INDL√ÜS BRUGERDATA
    function loadUserData() {
      try {
        const savedData = localStorage.getItem('mathAppData');
        if (savedData) {
          const data = JSON.parse(savedData);
          // Merge med standard data for at sikre alle felter er der
          userData = { ...userData, ...data };
        }
        
        // Indl√¶s Plus data separat (fra den nye struktur)
        try {
          const plusData = localStorage.getItem('plusData');
          if (plusData) {
            const data = JSON.parse(plusData);
            // Beregn total rigtige i Plus fra alle sv√¶rhedsgrader
            let plusTotal = 0;
            if (data.difficultyData) {
              Object.values(data.difficultyData).forEach(diff => {
                plusTotal += diff.correctCount || 0;
              });
            }
            userData.topics.plus.totalCorrect = plusTotal;
          }
        } catch (e) {
          console.log("Ingen Plus data fundet");
        }
        
        // Beregn samlet antal rigtige
        userData.totalCorrect = Object.values(userData.topics).reduce((sum, topic) => {
          return sum + (topic.totalCorrect || 0);
        }, 0);
        
      } catch (e) {
        console.log("Ingen tidligere data fundet, starter fra ny");
      }
    }

    // GEM BRUGERDATA
    function saveUserData() {
      localStorage.setItem('mathAppData', JSON.stringify(userData));
    }

    // TJEK AKTIV DAG
    function checkActiveDay() {
      const today = new Date().toDateString();
      
      if (!userData.lastActiveDate) {
        userData.lastActiveDate = today;
        saveUserData();
        return;
      }
      
      if (userData.lastActiveDate !== today) {
        userData.lastActiveDate = today;
        userData.activeDays++;
        saveUserData();
        updateStatsDisplay();
      }
    }

    // OPDATER STATISTIK VISNING
    function updateStatsDisplay() {
      document.getElementById('totalCorrect').textContent = userData.totalCorrect;
      document.getElementById('plusCorrect').textContent = userData.topics.plus.totalCorrect || 0;
      document.getElementById('activeDays').textContent = userData.activeDays;
      
      // Opdater progress bars (simplificeret - viser % af 100)
      const plusProgress = Math.min((userData.topics.plus.totalCorrect / 100) * 100, 100);
      document.getElementById('plusProgress').style.width = plusProgress + '%';
      
      // De andre emner viser 0 indtil de er implementeret
      document.getElementById('minusProgress').style.width = '0%';
      document.getElementById('gangeProgress').style.width = '0%';
      document.getElementById('divisionProgress').style.width = '0%';
    }

    // NULSTIL ALLE DATA
    function resetAllData() {
      if (confirm('Er du sikker p√• at du vil nulstille ALLE dine data? Dette kan ikke fortrydes!')) {
        // Reset til standard data
        userData = {
          totalCorrect: 0,
          activeDays: 1,
          lastActiveDate: new Date().toDateString(),
          topics: {
            plus: { totalCorrect: 0 },
            minus: { totalCorrect: 0 },
            gange: { totalCorrect: 0 },
            division: { totalCorrect: 0 }
          }
        };
        
        // Slet ogs√• Plus data
        localStorage.removeItem('plusData');
        
        // Gem ny data
        saveUserData();
        
        // Opdater visning
        updateStatsDisplay();
        
        alert('Alle data er nulstillet!');
      }
    }

    // HJ√ÜLPEFUNKTION TIL AT OPDATERE EMNE DATA (kan kaldes fra andre sider)
    window.updateTopicData = function(topic, correctCount) {
      if (!userData.topics[topic]) {
        userData.topics[topic] = { totalCorrect: 0 };
      }
      
      userData.topics[topic].totalCorrect = correctCount;
      
      // Beregn samlet antal rigtige
      userData.totalCorrect = Object.values(userData.topics).reduce((sum, topicData) => {
        return sum + (topicData.totalCorrect || 0);
      }, 0);
      
      // Gem data
      saveUserData();
      
      return userData.topics[topic].totalCorrect;
    };

    // HJ√ÜLPEFUNKTION TIL AT HENTE EMNE DATA
    window.getTopicData = function(topic) {
      return userData.topics[topic] || { totalCorrect: 0 };
    };
  </script>
</body>
</html>