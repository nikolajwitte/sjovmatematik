<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sjov Matematik - V√¶lg regnearter</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* TILPASSET STATS BAR TIL FORSIDEN */
    .stats-bar {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 15px;
      padding: 15px 25px;
      margin: 20px 0;
      display: flex;
      justify-content: space-around;
      color: white;
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }
    
    .stat-item {
      text-align: center;
    }
    
    .stat-label {
      font-size: 0.9rem;
      opacity: 0.9;
      margin-bottom: 5px;
    }
    
    .stat-value {
      font-size: 2rem;
      font-weight: bold;
    }
    
    /* MENU ITEMS MED NIVEAU INDIKATOR */
    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    
    .menu-item {
      background: white;
      border-radius: 15px;
      padding: 25px;
      text-decoration: none;
      color: #2d3748;
      display: block;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }
    
    .menu-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0,0,0,0.15);
      border-color: #48bb78;
    }
    
    .menu-icon {
      font-size: 3rem;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .menu-text {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 10px;
      text-align: center;
    }
    
    .menu-desc {
      color: #718096;
      text-align: center;
      display: block;
      margin-bottom: 15px;
    }
    
    .menu-level {
      position: absolute;
      top: 15px;
      right: 15px;
      background: #48bb78;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.9rem;
    }
    
    .menu-progress {
      height: 6px;
      background: #e2e8f0;
      border-radius: 3px;
      margin-top: 10px;
      overflow: hidden;
    }
    
    .menu-progress-fill {
      height: 100%;
      background: linear-gradient(to right, #48bb78, #38a169);
      border-radius: 3px;
      transition: width 0.5s ease;
    }
    
    /* COMING SOON TAGS */
    .coming-soon {
      background: #f7fafc;
      border: 2px dashed #cbd5e0;
      padding: 10px 20px;
      border-radius: 25px;
      color: #a0aec0;
      font-weight: 600;
    }
    
    /* RESPONSIVITET */
    @media (max-width: 768px) {
      .stats-bar {
        flex-direction: column;
        gap: 15px;
      }
      
      .stat-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      .stat-value {
        font-size: 1.8rem;
      }
      
      .menu-grid {
        grid-template-columns: 1fr;
      }
    }
    
    /* TOP EMNE SECTION */
    .top-topic {
      background: linear-gradient(135deg, #f6ad55 0%, #ed8936 100%);
      border-radius: 15px;
      padding: 20px;
      color: white;
      margin-top: 30px;
      box-shadow: 0 10px 20px rgba(237, 137, 54, 0.3);
    }
    
    .top-topic h3 {
      margin-top: 0;
      margin-bottom: 10px;
    }
    
    .top-topic p {
      margin-bottom: 0;
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1><i class="fas fa-calculator"></i> Sjov Matematik</h1>
      <p>Tr√¶n matematik fra 5. til 9. klasse. V√¶lg en regnearter at starte med!</p>
      
      <!-- SIMPLIFICERET STATS BAR -->
      <div class="stats-bar">
        <div class="stat-item">
          <div class="stat-label">Samlet antal rigtige</div>
          <div class="stat-value" id="totalCorrect">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">I tr√¶k rekord</div>
          <div class="stat-value" id="maxStreak">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Aktivitetsdage</div>
          <div class="stat-value" id="activeDays">1</div>
        </div>
      </div>
    </header>

    <main>
      <!-- TOP EMNE (VALGFRIT) -->
      <div class="top-topic" style="display: none;" id="topTopic">
        <h3><i class="fas fa-trophy"></i> Dit bedste emne</h3>
        <p>Du har flest rigtige i <span id="bestTopicName">Plus</span> (<span id="bestTopicScore">0</span> rigtige)</p>
      </div>
      
      <h2 style="margin-top: 30px;">V√¶lg et emne:</h2>
      <div class="menu-grid">
        <a href="pages/plus.html" class="menu-item">
          <div class="menu-level" id="plusLevel">1</div>
          <div class="menu-icon">‚ûï</div>
          <div class="menu-text">Plus</div>
          <small class="menu-desc">L√¶r at l√¶gge tal sammen</small>
          <div class="menu-progress">
            <div class="menu-progress-fill" id="plusProgress" style="width: 0%"></div>
          </div>
        </a>
        
        <a href="pages/minus.html" class="menu-item">
          <div class="menu-level" id="minusLevel">1</div>
          <div class="menu-icon">‚ûñ</div>
          <div class="menu-text">Minus</div>
          <small class="menu-desc">Tr√¶k tal fra hinanden</small>
          <div class="menu-progress">
            <div class="menu-progress-fill" id="minusProgress" style="width: 0%"></div>
          </div>
        </a>
        
        <a href="pages/gange.html" class="menu-item">
          <div class="menu-level" id="gangeLevel">1</div>
          <div class="menu-icon">‚úñÔ∏è</div>
          <div class="menu-text">Gange</div>
          <small class="menu-desc">Mestring af multiplikation</small>
          <div class="menu-progress">
            <div class="menu-progress-fill" id="gangeProgress" style="width: 0%"></div>
          </div>
        </a>
        
        <a href="pages/division.html" class="menu-item">
          <div class="menu-level" id="divisionLevel">1</div>
          <div class="menu-icon">‚ûó</div>
          <div class="menu-text">Division</div>
          <small class="menu-desc">Del tal ligeligt</small>
          <div class="menu-progress">
            <div class="menu-progress-fill" id="divisionProgress" style="width: 0%"></div>
          </div>
        </a>
      </div>
      
      <!-- KOMMENDE EMNER -->
      <div style="margin-top: 40px; text-align: center;">
        <h3>Snart tilg√¶ngelige emner:</h3>
        <div style="display: flex; justify-content: center; gap: 15px; margin-top: 15px; flex-wrap: wrap;">
          <span class="coming-soon"><i class="fas fa-pizza-slice"></i> Br√∏ker (¬Ω)</span>
          <span class="coming-soon"><i class="fas fa-percentage"></i> Procent (%)</span>
          <span class="coming-soon"><i class="fas fa-equals"></i> Ligninger (=)</span>
          <span class="coming-soon"><i class="fas fa-shapes"></i> Geometri (üìê)</span>
        </div>
      </div>
      
      <!-- RESET KNAP -->
      <div style="text-align: center; margin-top: 40px;">
        <button onclick="resetAllData()" class="button" style="background: #f56565; color: white;">
          <i class="fas fa-trash-alt"></i> Nulstil alle data
        </button>
        <p style="font-size: 0.8rem; color: #718096; margin-top: 5px;">Sletter alle dine fremskridt og nulstiller til niveau 1</p>
      </div>
    </main>
  </div>

  <script>
    // GLOBALE VARIABLER
    let userData = {
      totalCorrect: 0,
      maxStreak: 0,
      activeDays: 1,
      lastActiveDate: null,
      topics: {
        plus: { level: 1, correctCount: 0, streak: 0 },
        minus: { level: 1, correctCount: 0, streak: 0 },
        gange: { level: 1, correctCount: 0, streak: 0 },
        division: { level: 1, correctCount: 0, streak: 0 }
      }
    };

    // N√ÖR SIDEN INDL√ÜSES
    document.addEventListener('DOMContentLoaded', function() {
      loadUserData();
      updateStatsDisplay();
      updateTopicsDisplay();
      updateTopTopic();
      checkActiveDay();
    });

    // INDL√ÜS BRUGERDATA
    function loadUserData() {
      try {
        const savedData = localStorage.getItem('mathAppData');
        if (savedData) {
          const data = JSON.parse(savedData);
          // Merge med standard data for at sikre alle felter er der
          userData = { ...userData, ...data };
          
          // S√∏rg for at topics altid har alle felter
          Object.keys(userData.topics).forEach(topic => {
            userData.topics[topic] = { 
              level: userData.topics[topic].level || 1,
              correctCount: userData.topics[topic].correctCount || 0,
              streak: userData.topics[topic].streak || 0
            };
          });
        }
      } catch (e) {
        console.log("Ingen tidligere data fundet, starter fra ny");
      }
    }

    // GEM BRUGERDATA
    function saveUserData() {
      localStorage.setItem('mathAppData', JSON.stringify(userData));
    }

    // TJEK AKTIV DAG
    function checkActiveDay() {
      const today = new Date().toDateString();
      
      if (!userData.lastActiveDate) {
        userData.lastActiveDate = today;
        saveUserData();
        return;
      }
      
      if (userData.lastActiveDate !== today) {
        userData.lastActiveDate = today;
        userData.activeDays++;
        saveUserData();
        updateStatsDisplay();
      }
    }

    // OPDATER STATISTIK VISNING
    function updateStatsDisplay() {
      document.getElementById('totalCorrect').textContent = userData.totalCorrect;
      document.getElementById('maxStreak').textContent = userData.maxStreak;
      document.getElementById('activeDays').textContent = userData.activeDays;
    }

    // OPDATER EMNE VISNING
    function updateTopicsDisplay() {
      // Plus
      const plusData = userData.topics.plus;
      document.getElementById('plusLevel').textContent = plusData.level;
      const plusProgress = Math.min((plusData.correctCount / 50) * 100, 100);
      document.getElementById('plusProgress').style.width = plusProgress + '%';
      
      // Minus
      const minusData = userData.topics.minus;
      document.getElementById('minusLevel').textContent = minusData.level;
      const minusProgress = Math.min((minusData.correctCount / 50) * 100, 100);
      document.getElementById('minusProgress').style.width = minusProgress + '%';
      
      // Gange
      const gangeData = userData.topics.gange;
      document.getElementById('gangeLevel').textContent = gangeData.level;
      const gangeProgress = Math.min((gangeData.correctCount / 50) * 100, 100);
      document.getElementById('gangeProgress').style.width = gangeProgress + '%';
      
      // Division
      const divisionData = userData.topics.division;
      document.getElementById('divisionLevel').textContent = divisionData.level;
      const divisionProgress = Math.min((divisionData.correctCount / 50) * 100, 100);
      document.getElementById('divisionProgress').style.width = divisionProgress + '%';
    }

    // FIND BEDSTE EMNE
    function updateTopTopic() {
      let bestTopic = null;
      let bestScore = -1;
      
      Object.entries(userData.topics).forEach(([topic, data]) => {
        if (data.correctCount > bestScore) {
          bestScore = data.correctCount;
          bestTopic = topic;
        }
      });
      
      if (bestScore > 10) { // Vis kun hvis brugeren har mere end 10 rigtige
        const topicNames = {
          plus: 'Plus',
          minus: 'Minus', 
          gange: 'Gange',
          division: 'Division'
        };
        
        document.getElementById('bestTopicName').textContent = topicNames[bestTopic];
        document.getElementById('bestTopicScore').textContent = bestScore;
        document.getElementById('topTopic').style.display = 'block';
      }
    }

    // NULSTIL ALLE DATA
    function resetAllData() {
      if (confirm('Er du sikker p√• at du vil nulstille ALLE dine data? Dette kan ikke fortrydes!')) {
        // Reset til standard data
        userData = {
          totalCorrect: 0,
          maxStreak: 0,
          activeDays: 1,
          lastActiveDate: new Date().toDateString(),
          topics: {
            plus: { level: 1, correctCount: 0, streak: 0 },
            minus: { level: 1, correctCount: 0, streak: 0 },
            gange: { level: 1, correctCount: 0, streak: 0 },
            division: { level: 1, correctCount: 0, streak: 0 }
          }
        };
        
        // Gem ogs√• lokale data for hvert emne
        localStorage.removeItem('plusData');
        localStorage.removeItem('minusData');
        localStorage.removeItem('gangeData');
        localStorage.removeItem('divisionData');
        
        // Gem ny data
        saveUserData();
        
        // Opdater visning
        updateStatsDisplay();
        updateTopicsDisplay();
        document.getElementById('topTopic').style.display = 'none';
        
        alert('Alle data er nulstillet! Du starter fra niveau 1.');
      }
    }

    // HJ√ÜLPEFUNKTION TIL AT OPDATERE EMNE DATA (kan kaldes fra andre sider)
    window.updateTopicData = function(topic, isCorrect) {
      if (!userData.topics[topic]) {
        userData.topics[topic] = { level: 1, correctCount: 0, streak: 0 };
      }
      
      if (isCorrect) {
        // Opdater correct count
        userData.topics[topic].correctCount++;
        userData.totalCorrect++;
        
        // Opdater streak
        userData.topics[topic].streak++;
        if (userData.topics[topic].streak > userData.maxStreak) {
          userData.maxStreak = userData.topics[topic].streak;
        }
        
        // Automatisk niveau opgradering (hver 5 rigtige)
        if (userData.topics[topic].correctCount % 5 === 0 && userData.topics[topic].level < 5) {
          userData.topics[topic].level++;
        }
      } else {
        // Nulstil streak ved forkert svar
        userData.topics[topic].streak = 0;
      }
      
      // Gem data
      saveUserData();
      
      return userData.topics[topic].level;
    };

    // HJ√ÜLPEFUNKTION TIL AT HENTE EMNE DATA
    window.getTopicData = function(topic) {
      return userData.topics[topic] || { level: 1, correctCount: 0, streak: 0 };
    };
  </script>
</body>
</html>